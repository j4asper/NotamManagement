@page "/"
@using Microsoft.AspNetCore.Components.Authorization
@using NotamManagement.Core.Services

@inject ApiAuthenticationStateProvider AuthStateProvider
@inject NavigationManager Navigation

<PageTitle>Home</PageTitle>

<AuthorizeView>
    <Authorized>
        <MudStack Row="true">
            <NotamListViewComponent Notams="Notams" />

            <NotamActionListViewComponent NotamActions="NotamActions" />
        </MudStack>
    </Authorized>
    <NotAuthorized>
        <h1>You are not authorized to view this page</h1>
    </NotAuthorized>

</AuthorizeView>




@code
{
    [Inject] public INotamService NotamService { get; set; } = null!;
    
    private List<Notam> Notams = [];
    private List<NotamAction> NotamActions = [];

    protected override async Task OnInitializedAsync()
    {
        var notams = await NotamService.GetAllNotamsAsync();

        Notams = notams.ToList();
        
        NotamActions.Add(new NotamAction
        {
            Id = 1,
            OrganizationId = 1,
            Importance = Importance.Important,
            NotamId = 1,
            Note = "Look at this"
        });
        
        NotamActions.Add(new NotamAction
        {
            Id = 2,
            OrganizationId = 2,
            Importance = Importance.Default,
            NotamId = 2,
            Note = "Look at this"
        });
        
        NotamActions.Add(new NotamAction
        {
            Id = 3,
            OrganizationId = 1,
            Importance = Importance.Ignore,
            NotamId = 3,
            Note = "Look at this",
        });
    }
}
